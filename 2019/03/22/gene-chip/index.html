<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="description" content="基因芯片分析"><meta name="keywords" content="生物信息,R语言"><meta name="author" content="双语之城"><meta name="copyright" content="双语之城"><title>基因芯片分析 | 双语之城的博客</title><link rel="shortcut icon" href="/logo.png"><link rel="stylesheet" href="/css/index.css?version=1.6.1"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css?version=1.6.1"><link rel="dns-prefetch" href="https://cdn.staticfile.org"><link rel="dns-prefetch" href="https://cdn.bootcss.com"><link rel="dns-prefetch" href="https://creativecommons.org"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  }
} </script><meta name="generator" content="Hexo 5.4.0"></head><body><canvas class="fireworks"></canvas><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true"></i><div id="sidebar"><div class="toggle-sidebar-info text-center"><span data-toggle="Toggle article">Toggle site</span><hr></div><div class="sidebar-toc"><div class="sidebar-toc__title">Catalog</div><div class="sidebar-toc__progress"><span class="progress-notice">You've read</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar"></div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%B8%80-%E8%8E%B7%E5%8F%96%E6%95%B0%E6%8D%AE"><span class="toc-number">1.</span> <span class="toc-text">一. 获取数据</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BA%8C-%E6%95%B0%E6%8D%AE%E9%A2%84%E5%A4%84%E7%90%86"><span class="toc-number">2.</span> <span class="toc-text">二. 数据预处理</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-%E8%B4%A8%E9%87%8F%E6%A3%80%E9%AA%8C"><span class="toc-number">2.1.</span> <span class="toc-text">1.质量检验</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#step0-%E9%A6%96%E5%85%88%E5%AF%B9%E8%8A%AF%E7%89%87%E8%BF%9B%E8%A1%8C%E8%B4%A8%E9%87%8F%E6%A3%80%E6%B5%8B-%E6%98%AF%E5%90%A6%E5%AD%98%E5%9C%A8spatial-artifact"><span class="toc-number">2.1.1.</span> <span class="toc-text">step0.首先对芯片进行质量检测(是否存在spatial artifact)</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-%E6%A0%87%E5%87%86%E5%8C%96"><span class="toc-number">2.2.</span> <span class="toc-text">2.标准化</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#step1-%E8%83%8C%E6%99%AF%E5%A4%84%E7%90%86%E3%80%81%E5%BD%92%E4%B8%80%E5%8C%96%EF%BC%9AMAS5-rma-gcrma"><span class="toc-number">2.2.1.</span> <span class="toc-text">step1.背景处理、归一化：MAS5&#x2F;rma&#x2F;gcrma</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#RMA%E6%8B%96%E5%B0%BE%E6%83%85%E5%86%B5%E6%9C%80%E5%B0%91%EF%BC%8C%E7%9B%B8%E5%AF%B9%E8%80%8C%E8%A8%80%E6%9C%80%E5%A5%BD"><span class="toc-number">2.2.1.0.0.1.</span> <span class="toc-text">RMA拖尾情况最少，相对而言最好</span></a></li></ol></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-%E8%BF%87%E6%BB%A4%E6%8E%A2%E9%92%88"><span class="toc-number">2.3.</span> <span class="toc-text">3.过滤探针</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-%E6%8E%A2%E9%92%88%E6%B3%A8%E9%87%8A"><span class="toc-number">2.4.</span> <span class="toc-text">4.探针注释</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-%E5%90%88%E5%B9%B6%E9%87%8D%E5%A4%8D%E6%8E%A2%E9%92%88"><span class="toc-number">2.5.</span> <span class="toc-text">5. 合并重复探针</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%B3%A8%E6%84%8F%EF%BC%8C%E6%AD%A4%E5%A4%84%E7%9A%84%E7%94%9F%E6%88%90%E6%95%B0%E6%8D%AE%E6%98%AF%E7%BB%8F%E8%BF%87RMA%E4%BF%AE%E6%AD%A3%E7%9A%84%EF%BC%8C%E5%9B%A0%E6%AD%A4%E6%98%AF%E6%B1%82log%E5%90%8E%E7%9A%84%E5%80%BC"><span class="toc-number">2.5.0.0.1.</span> <span class="toc-text">注意，此处的生成数据是经过RMA修正的，因此是求log后的值</span></a></li></ol></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%B8%89-%E5%9F%BA%E5%9B%A0%E7%9A%84%E5%B7%AE%E5%BC%82%E8%A1%A8%E8%BE%BE%E5%88%86%E6%9E%90"><span class="toc-number">3.</span> <span class="toc-text">三. 基因的差异表达分析</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-t-test"><span class="toc-number">3.0.1.</span> <span class="toc-text">1. t.test</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E5%80%8D%E6%95%B0%E6%B3%95"><span class="toc-number">3.0.2.</span> <span class="toc-text">2.倍数法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-z%E5%80%BC"><span class="toc-number">3.0.3.</span> <span class="toc-text">3.z值</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E7%AD%9B%E9%80%89"><span class="toc-number">3.0.4.</span> <span class="toc-text">4.筛选</span></a></li></ol></li></ol></li></ol></div></div><div class="author-info hide"><div class="author-info__avatar text-center"><img src="/img/avatar.png"></div><div class="author-info__name text-center">双语之城</div><div class="author-info__description text-center"></div><hr><div class="author-info-articles"><a class="author-info-articles__archives article-meta" href="/archives"><span class="pull-left">Articles</span><span class="pull-right">26</span></a><a class="author-info-articles__tags article-meta" href="/tags"><span class="pull-left">Tags</span><span class="pull-right">19</span></a></div><hr><div class="author-info-links"><div class="author-info-links__title text-center">Friends</div><a class="author-info-links__name text-center" target="_blank" rel="noopener" href="http://chamelion.top/">chamelion</a><a class="author-info-links__name text-center" target="_blank" rel="noopener" href="http://www.gislxz.top/">Yui</a><a class="author-info-links__name text-center" target="_blank" rel="noopener" href="https://dimsmary.tech/">Dimsmary</a><a class="author-info-links__name text-center" target="_blank" rel="noopener" href="https://sydddl.github.io/">DeathSprout</a><a class="author-info-links__name text-center" target="_blank" rel="noopener" href="https://windy810.github.io/">WSindy</a></div></div></div><div id="content-outer"><div id="top-container" style="background-image: url(/sabar.jpg)"><div id="page-header"><span class="pull-left"> <a id="site-name" href="/">双语之城的博客</a></span><i class="fa fa-bars toggle-menu pull-right" aria-hidden="true"></i><span class="pull-right menus"><a class="site-page" href="/">Home</a><a class="site-page" href="/archives">Archives</a><a class="site-page" href="/tags">Tags</a><a class="site-page" href="/categories">Categories</a></span></div><div id="post-info"><div id="post-title">基因芯片分析</div><div id="post-meta"><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2019-03-22</time></div></div></div><div class="layout" id="content-inner"><article id="post"><div class="article-container" id="post-content"><p>基因芯片分析是生物信息学的重要应用之一，今天总结其中一种简单的使用方法。</p>
<span id="more"></span>
<h1 id="一-获取数据"><a href="#一-获取数据" class="headerlink" title="一. 获取数据"></a>一. 获取数据</h1><p>样本数据选取了论文<a target="_blank" rel="noopener" href="https://www.ncbi.nlm.nih.gov/pubmed/22915760">Molecular subsets of mantle cell lymphoma defined by the IGHV mutational status and SOX11 expression have distinct biologic and clinical features.</a>的实验数据，该套数据的下载网址：<br><a target="_blank" rel="noopener" href="https://www.ncbi.nlm.nih.gov/geo/download/?acc=GSE36000&amp;format=file">https://www.ncbi.nlm.nih.gov/geo/download/?acc=GSE36000&amp;format=file</a><br>从NCBI的GEO数据库获取数据的全部信息<br><a target="_blank" rel="noopener" href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE36000">https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE36000</a></p>
<img src="/2019/03/22/gene-chip/GSMsource.png" class="">
<p>这张芯片主要是研究来自Mantle细胞淋巴瘤（MCL）患者的B细胞淋巴细胞的免疫球蛋白重链可变（IGHV）基因的突变（MUT）与非突变(UNMUT)<br>芯片共38张，其中24张为突变型（MUT），14张为非突变型（UNMUT）</p>
<h1 id="二-数据预处理"><a href="#二-数据预处理" class="headerlink" title="二. 数据预处理"></a>二. 数据预处理</h1><p>过程梳理<br>质量检测——背景处理、归一化、汇总——探针注释——合并重复探针</p>
<h2 id="1-质量检验"><a href="#1-质量检验" class="headerlink" title="1.质量检验"></a>1.质量检验</h2><p>数据读入</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">#初次使用，下载 CLL package</span><br><span class="line">#library(BiocInstaller)</span><br><span class="line">#biocLite(&quot;CLL&quot;)</span><br><span class="line">#biocLite(&quot;simpleaffy&quot;)</span><br><span class="line">#install.packages(&quot;scales&quot;)</span><br><span class="line"></span><br><span class="line">library(affy)</span><br><span class="line">library(tcltk)</span><br><span class="line">library(gcrma)</span><br><span class="line">library(RColorBrewer)</span><br><span class="line">library(simpleaffy)</span><br><span class="line">library(CLL)</span><br><span class="line"></span><br><span class="line">setwd(&quot;E:/生信/大三/转录组学&quot;)</span><br><span class="line">geneCELs=list.celfiles(&#x27;E:/生信/大三/转录组学/GSE36000_RAW/&#x27;,full.name=T)</span><br><span class="line">data.raw&lt;-ReadAffy(filenames=geneCELs)</span><br><span class="line">#basename(geneCELs)     #查看文件名</span><br><span class="line">#由于数据分布本身极不规则，这里通过sublime text的优质工具便捷导入名称</span><br><span class="line">treats &lt;- strsplit(&quot;UNMUT UNMUT UNMUT UNMUT UNMUT MUT MUT UNMUT UNMUT UNMUT MUT UNMUT MUT MUT MUT MUT MUT MUT MUT MUT MUT MUT UNMUT MUT MUT MUT MUT MUT MUT UNMUT UNMUT MUT MUT MUT MUT MUT UNMUT UNMUT&quot;, &quot; &quot;)[[1]]</span><br><span class="line">snames &lt;- strsplit(&quot;UNMUT1 UNMUT2 UNMUT3 UNMUT4 UNMUT5 MUT1 MUT2 UNMUT6 UNMUT7 UNMUT8 MUT3 UNMUT9 MUT4 MUT5 MUT6 MUT7 MUT8 MUT9 MUT10 MUT11 MUT12 MUT13 UNMUT10 MUT14 MUT15 MUT16 MUT17 MUT18 MUT19 UNMUT11 UNMUT12 MUT20 MUT21 MUT22 MUT23 MUT24 UNMUT13 UNMUT14&quot;, &quot; &quot;)[[1]]</span><br><span class="line">sampleNames(data.raw) &lt;- snames</span><br></pre></td></tr></table></figure>
<h3 id="step0-首先对芯片进行质量检测-是否存在spatial-artifact"><a href="#step0-首先对芯片进行质量检测-是否存在spatial-artifact" class="headerlink" title="step0.首先对芯片进行质量检测(是否存在spatial artifact)"></a>step0.首先对芯片进行质量检测(是否存在spatial artifact)</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">for (i in 1:length(sampleNames(data.raw)))&#123;</span><br><span class="line">  name = paste(&quot;image&quot;,sampleNames(data.raw)[i],&quot;.jpg&quot;,sep=&quot;&quot;)</span><br><span class="line">  jpeg(name)</span><br><span class="line">  image(data.raw[,i])</span><br><span class="line">  dev.off()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>下面为MUT1芯片，所有芯片均完好，无spatial artifact</p>
<img src="/2019/03/22/gene-chip/imageMUT1.jpg" class="" title="MUT1">
<h2 id="2-标准化"><a href="#2-标准化" class="headerlink" title="2.标准化"></a>2.标准化</h2><h3 id="step1-背景处理、归一化：MAS5-rma-gcrma"><a href="#step1-背景处理、归一化：MAS5-rma-gcrma" class="headerlink" title="step1.背景处理、归一化：MAS5/rma/gcrma"></a>step1.背景处理、归一化：MAS5/rma/gcrma</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># mas5</span><br><span class="line">data.raw.mas5 &lt;- mas5(data.raw)</span><br><span class="line">data.mas5.Matrix &lt;- exprs(data.raw.mas5)    #</span><br><span class="line"># rma</span><br><span class="line">data.raw.rma &lt;- rma(data.raw)</span><br><span class="line">data.rma.Matrix &lt;- exprs(data.raw.rma)</span><br><span class="line"># gcrma</span><br><span class="line">data.raw.gcrma &lt;- gcrma(data.raw)</span><br><span class="line">data.gcrma.Matrix &lt;- exprs(data.raw.gcrma)</span><br><span class="line">## boxplot</span><br><span class="line">boxplot(data.mas5.Matrix, las=3, ylim=c(0,600), main=&quot;MAS 5.0&quot;)</span><br><span class="line">boxplot(data.rma.Matrix, las=3, ylim=c(0,8), main=&quot;RMA&quot;)</span><br><span class="line">boxplot(data.gcrma.Matrix, las=3, ylim=c(0,8), main=&quot;gcRMA&quot;)</span><br></pre></td></tr></table></figure>
<img src="/2019/03/22/gene-chip/mas.png" class="" title="MAS boxplot">
<img src="/2019/03/22/gene-chip/rma.png" class="" title="RMA boxplot">
<img src="/2019/03/22/gene-chip/gcrma.png" class="" title="gcRMA boxplot">
<h6 id="RMA拖尾情况最少，相对而言最好"><a href="#RMA拖尾情况最少，相对而言最好" class="headerlink" title="RMA拖尾情况最少，相对而言最好"></a>RMA拖尾情况最少，相对而言最好</h6><h2 id="3-过滤探针"><a href="#3-过滤探针" class="headerlink" title="3.过滤探针"></a>3.过滤探针</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">calls &lt;- mas5calls(data.raw) # 获得探针的PMA信息</span><br><span class="line">calls &lt;- exprs(calls) # 提取包含探针的PMA信息的表达矩阵</span><br><span class="line">head(calls)</span><br><span class="line">present &lt;- rowSums(calls == &quot;P&quot;) # 统计每个探针在所有样本中分类为&quot;P&quot;的个数</span><br><span class="line">present &lt;- which(present != 0) # 提取至少在一个样本中表达的探针</span><br><span class="line">rmaFiltered &lt;- data.raw.rma[present,] # 留下至少在一个样本中表达的探针</span><br><span class="line">#nrow(rmaFiltered)</span><br><span class="line">#Features </span><br><span class="line">#   38652 </span><br></pre></td></tr></table></figure>
<img src="/2019/03/22/gene-chip/rmaout.png" class="" title="RMA操作的输出">

<h2 id="4-探针注释"><a href="#4-探针注释" class="headerlink" title="4.探针注释"></a>4.探针注释</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">library(GEOquery)</span><br><span class="line">gse36&lt;-getGEO(&#x27;GSE36000&#x27;,destdir =&quot;.&quot;) #根据GSE号来下载数据，下载_series_matrix.txt.gz</span><br><span class="line">gpl570&lt;-getGEO(&#x27;GPL570&#x27;,destdir =&quot;.&quot;)  #根据GPL号下载的是芯片设计的信息, soft文件</span><br><span class="line"></span><br><span class="line">colnames(Table(gpl570))</span><br><span class="line"> #提取探针注释信息，保留第1列和第4列</span><br><span class="line">genename &lt;- Table(gpl515)[,c(1,4)]</span><br><span class="line">exprSet &lt;- as.data.frame(exprs(gse382[[1]]))# 得到表达矩阵，行名为ID，需要转换</span><br><span class="line">#转换ID为gene name</span><br><span class="line">exprSet$ID &lt;- rownames(exprSet)</span><br><span class="line">express &lt;- merge(x = genename, y = exprSet, by = &quot;ID&quot;)</span><br><span class="line">express$ID =NULL</span><br></pre></td></tr></table></figure>

<h2 id="5-合并重复探针"><a href="#5-合并重复探针" class="headerlink" title="5. 合并重复探针"></a>5. 合并重复探针</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">#安装hgu133plus2.db包</span><br><span class="line">#if (!requireNamespace(&quot;BiocManager&quot;, quietly = TRUE))</span><br><span class="line">#    install.packages(&quot;BiocManager&quot;)</span><br><span class="line">#BiocManager::install(&quot;hgu133plus2.db&quot;, version = &quot;3.8&quot;)</span><br><span class="line"></span><br><span class="line">library(hgu133plus2.db) #加载芯片注释包</span><br><span class="line">columns(hgu133plus2.db) #查看芯片注释包提供的注释信息</span><br><span class="line">probe2symbol &lt;- toTable(hgu133plus2SYMBOL) #提取注释信息，这里选择GENESYMBOL进行注释。也可以选择其他ID进行注释，详情请见注释包的技术支持文档。</span><br><span class="line">exprSet &lt;- as.data.frame(exprs(rmaFiltered)) #提取表达矩阵，转换为data.frame对象</span><br><span class="line">head(exprSet) #查看表达矩阵</span><br></pre></td></tr></table></figure>
<img src="/2019/03/22/gene-chip/exprSet.png" class="" title="exprSet屏幕回显">
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">exprSet$probe_id &lt;- rownames(exprSet) #将行名转化为probe_id</span><br><span class="line"></span><br><span class="line">probeset &lt;- rownames(exprSet) #提取行名为探针名</span><br><span class="line">Symbol &lt;- as.character(as.list(hgu133plus2SYMBOL[probeset])) #提取探针对应的GENESYMBOL</span><br><span class="line">exprSet_symbol &lt;- cbind(Symbol,exprSet)</span><br><span class="line"></span><br><span class="line">#采取数据中位数代替重复值</span><br><span class="line">exprSet_symbol &lt;- aggregate(x = exprSet_symbol[,-1],by = list(exprSet_symbol$Symbol), FUN = median)</span><br><span class="line">exprSet_symbol$probe_id &lt;- NULL</span><br><span class="line">dim(exprSet_symbol)</span><br><span class="line">#[1] 15672    39</span><br></pre></td></tr></table></figure>
<img src="/2019/03/22/gene-chip/pretreat_result.png" class="" title="预处理最终结果">
<h5 id="注意，此处的生成数据是经过RMA修正的，因此是求log后的值"><a href="#注意，此处的生成数据是经过RMA修正的，因此是求log后的值" class="headerlink" title="注意，此处的生成数据是经过RMA修正的，因此是求log后的值"></a>注意，此处的生成数据是经过RMA修正的，因此是求log后的值</h5><h1 id="三-基因的差异表达分析"><a href="#三-基因的差异表达分析" class="headerlink" title="三. 基因的差异表达分析"></a>三. 基因的差异表达分析</h1><p>将数据处理成纯数据</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">exprSet_symbol_1&lt;-exprSet_symbol[,-1]</span><br><span class="line">rownames(exprSet_symbol_1)&lt;-exprSet_symbol[,1]</span><br></pre></td></tr></table></figure>
<h3 id="1-t-test"><a href="#1-t-test" class="headerlink" title="1. t.test"></a>1. t.test</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">unmut&lt;-exprSet_symbol_1[,c(1,2,3,4,5,8,9,10,12,23,30,31,37,38)]</span><br><span class="line">mut&lt;-exprSet_symbol_1[,c(6,7,11,13,14,15,16,17,18,19,20,21,22,24,25,26,27,28,29,32,33,34,35,36)]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">for(i in 1:nrow(exprSet_symbol_1))&#123;</span><br><span class="line">    p_value[i]&lt;-t.test(unmut[i,],mut[i,])$p.value</span><br><span class="line">&#125;</span><br><span class="line">exprSet_symbol_1$p_value&lt;-p_value</span><br><span class="line">exprSet_symbol_p_005 &lt;- exprSet_symbol_1[p_value&lt;0.05,]</span><br><span class="line">#dim(exprSet_symbol_p)</span><br><span class="line">#[1] 2503   39</span><br><span class="line">exprSet_symbol_p_001 &lt;- exprSet_symbol_1[p_value&lt;0.01,]</span><br><span class="line">#dim(exprSet_symbol_p)</span><br><span class="line">#[1] 969  39</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">exprSet_symbol_unlog&lt;-2^exprSet_symbol_1</span><br><span class="line">unmut&lt;-exprSet_symbol_unlog[,c(1,2,3,4,5,8,9,10,12,23,30,31,37,38)]</span><br><span class="line">mut&lt;-exprSet_symbol_unlog[,c(6,7,11,13,14,15,16,17,18,19,20,21,22,24,25,26,27,28,29,32,33,34,35,36)]</span><br></pre></td></tr></table></figure>
<h3 id="2-倍数法"><a href="#2-倍数法" class="headerlink" title="2.倍数法"></a>2.倍数法</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">unmut_avg&lt;-apply(unmut,1,mean)</span><br><span class="line">mut_avg&lt;-apply(mut,1,mean)</span><br><span class="line">exprSet_symbol_1$unmut_avg&lt;-unmut_avg</span><br><span class="line">exprSet_symbol_1$mut_avg&lt;-mut_avg</span><br><span class="line">exprSet_symbol_fold_2 &lt;- exprSet_symbol_1[2^(log2(unmut_avg/mut_avg))&gt;2,]</span><br><span class="line"># dim(exprSet_symbol_fold)</span><br><span class="line"># [1] 407  41</span><br><span class="line">exprSet_symbol_fold_3 &lt;- exprSet_symbol_1[2^(log2(unmut_avg/mut_avg))&gt;3,]</span><br><span class="line"># dim(exprSet_symbol_fold_3)</span><br><span class="line"># [1] 145  43</span><br></pre></td></tr></table></figure>

<h3 id="3-z值"><a href="#3-z值" class="headerlink" title="3.z值"></a>3.z值</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">exprSet_symbol_1$avg_cha&lt;-abs(unmut_avg-mut_avg)</span><br><span class="line">exprSet_symbol_z&lt;-vector(length=nrow(exprSet_symbol_1))</span><br><span class="line">for(i in 1:nrow(exprSet_symbol_1))&#123;</span><br><span class="line">    exprSet_symbol_z[i]&lt;-(exprSet_symbol_1$avg_cha[i]-mean(exprSet_symbol_1$avg_cha))/sd(exprSet_symbol_1$avg_cha)</span><br><span class="line">&#125;</span><br><span class="line">exprSet_symbol_1$exprSet_symbol_z&lt;-abs(exprSet_symbol_z)</span><br><span class="line">exprSet_symbol_zscore_196&lt;-exprSet_symbol_1[exprSet_symbol_z&gt;1.96,]</span><br><span class="line"># dim(exprSet_symbol_zscore)</span><br><span class="line"># [1] 305  43</span><br><span class="line">exprSet_symbol_zscore_258&lt;-exprSet_symbol_1[exprSet_symbol_z&gt;2.58,]</span><br><span class="line"># dim(exprSet_symbol_zscore_258)</span><br><span class="line"># [1] 224  43</span><br></pre></td></tr></table></figure>


<h3 id="4-筛选"><a href="#4-筛选" class="headerlink" title="4.筛选"></a>4.筛选</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">#t 0.05  倍数 2</span><br><span class="line">exprSet_symbol_t005_fold2&lt;-exprSet_symbol_fold_2[exprSet_symbol_fold_2$p_value&lt;0.05,]</span><br><span class="line"># dim(exprSet_symbol_t005_fold2)</span><br><span class="line"># [1] 283  43</span><br><span class="line"></span><br><span class="line">#t 0.05  倍数 3</span><br><span class="line">exprSet_symbol_t005_fold3&lt;-exprSet_symbol_fold_3[exprSet_symbol_fold_3$p_value&lt;0.05,]</span><br><span class="line"># dim(exprSet_symbol_t005_fold3)</span><br><span class="line"># [1] 116  43</span><br><span class="line"></span><br><span class="line">#t 0.05  z 0.05</span><br><span class="line">exprSet_symbol_t005_z005&lt;-exprSet_symbol_p_005[exprSet_symbol_p_005$exprSet_symbol_z&gt;1.96,]</span><br><span class="line"># dim(exprSet_symbol_t005_z005)</span><br><span class="line"># [1] 174  43</span><br><span class="line"></span><br><span class="line">#t 0.05  z 0.01</span><br><span class="line">exprSet_symbol_t005_z001&lt;-exprSet_symbol_p_005[exprSet_symbol_p_005$exprSet_symbol_z&gt;2.58,]</span><br><span class="line"># dim(exprSet_symbol_t005_z001)</span><br><span class="line"># [1] 141  43</span><br></pre></td></tr></table></figure>


<p>（P=0.01&amp;&amp;倍数法3）、（P=0.01&amp;&amp;Z值法0.05）</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">exprSet_symbol_t001_fold3&lt;-exprSet_symbol_fold_3[exprSet_symbol_fold_3$p_value&lt;0.01,]</span><br><span class="line">exprSet_symbol_t001_fold3_z005&lt;-exprSet_symbol_t001_fold3[exprSet_symbol_t001_fold3$exprSet_symbol_z&gt;1.96,]</span><br><span class="line"># dim(exprSet_symbol_t001_fold3_z005)</span><br><span class="line"># [1] 13 43</span><br></pre></td></tr></table></figure>


</div></article><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E7%94%9F%E7%89%A9%E4%BF%A1%E6%81%AF/">生物信息</a><a class="post-meta__tags" href="/tags/R%E8%AF%AD%E8%A8%80/">R语言</a></div><nav id="pagination"><div class="prev-post pull-left"><a href="/2019/04/04/ubuntu/"><i class="fa fa-chevron-left">  </i><span>Linux Ubuntu操作汇总</span></a></div><div class="next-post pull-right"><a href="/2019/01/10/R-Linear-regression/"><span>R语言线性回归总结</span><i class="fa fa-chevron-right"></i></a></div></nav></div></div><footer class="footer-bg" style="background-image: url(/sabar.jpg)"><div class="layout" id="footer"><div class="copyright">&copy;2018 - 2022 By 双语之城</div><div class="framework-info"><span>Driven - </span><a target="_blank" rel="noopener" href="http://hexo.io"><span>Hexo</span></a><span class="footer-separator">|</span><span>Theme - </span><a target="_blank" rel="noopener" href="https://github.com/Molunerfinn/hexo-theme-melody"><span>Melody</span></a></div><div class="busuanzi"><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span id="busuanzi_container_page_pv"><i class="fa fa-file-o"></i><span id="busuanzi_value_page_pv"></span><span></span></span></div></div></footer><i class="fa fa-arrow-up" id="go-up" aria-hidden="true"></i><script src="https://cdn.jsdelivr.net/npm/animejs@latest/anime.min.js"></script><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@latest/velocity.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-ui-pack@latest/velocity.ui.min.js"></script><script src="/js/utils.js?version=1.6.1"></script><script src="/js/fancybox.js?version=1.6.1"></script><script src="/js/sidebar.js?version=1.6.1"></script><script src="/js/copy.js?version=1.6.1"></script><script src="/js/fireworks.js?version=1.6.1"></script><script src="/js/transition.js?version=1.6.1"></script><script src="/js/scroll.js?version=1.6.1"></script><script src="/js/head.js?version=1.6.1"></script><script>if(/Android|webOS|iPhone|iPod|BlackBerry/i.test(navigator.userAgent)) {
  $('#nav').addClass('is-mobile')
  $('footer').addClass('is-mobile')
}</script><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"jsonPath":"/live2dw/assets/hijiki.model.json"},"display":{"position":"right","width":150,"height":300},"mobile":{"show":true},"log":false});</script></body></html>