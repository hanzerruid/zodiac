<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="description" content="R语言线性回归总结"><meta name="keywords" content="R语言,线性回归"><meta name="author" content="双语之城"><meta name="copyright" content="双语之城"><title>R语言线性回归总结 | 双语之城的博客</title><link rel="shortcut icon" href="/logo.png"><link rel="stylesheet" href="/css/index.css?version=1.6.1"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css?version=1.6.1"><link rel="dns-prefetch" href="https://cdn.staticfile.org"><link rel="dns-prefetch" href="https://cdn.bootcss.com"><link rel="dns-prefetch" href="https://creativecommons.org"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  }
} </script><meta name="generator" content="Hexo 5.4.0"></head><body><canvas class="fireworks"></canvas><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true"></i><div id="sidebar"><div class="toggle-sidebar-info text-center"><span data-toggle="Toggle article">Toggle site</span><hr></div><div class="sidebar-toc"><div class="sidebar-toc__title">Catalog</div><div class="sidebar-toc__progress"><span class="progress-notice">You've read</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar"></div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%BA%BF%E6%80%A7%E5%9B%9E%E5%BD%92%E8%AE%A1%E7%AE%97%E5%88%86%E4%B8%BA%E4%BB%A5%E4%B8%8B%E5%87%A0%E7%82%B9"><span class="toc-number">1.</span> <span class="toc-text">线性回归计算分为以下几点</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E2%80%93-To-Be-Continued-%E2%80%93"><span class="toc-number"></span> <span class="toc-text">– To  Be  Continued –</span></a></div></div><div class="author-info hide"><div class="author-info__avatar text-center"><img src="/img/avatar.png"></div><div class="author-info__name text-center">双语之城</div><div class="author-info__description text-center"></div><hr><div class="author-info-articles"><a class="author-info-articles__archives article-meta" href="/archives"><span class="pull-left">Articles</span><span class="pull-right">24</span></a><a class="author-info-articles__tags article-meta" href="/tags"><span class="pull-left">Tags</span><span class="pull-right">19</span></a></div></div></div><div id="content-outer"><div id="top-container" style="background-image: url(/sabar.jpg)"><div id="page-header"><span class="pull-left"> <a id="site-name" href="/">双语之城的博客</a></span><i class="fa fa-bars toggle-menu pull-right" aria-hidden="true"></i><span class="pull-right menus"><a class="site-page" href="/">Home</a><a class="site-page" href="/archives">Archives</a><a class="site-page" href="/tags">Tags</a><a class="site-page" href="/categories">Categories</a></span></div><div id="post-info"><div id="post-title">R语言线性回归总结</div><div id="post-meta"><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2019-01-10</time></div></div></div><div class="layout" id="content-inner"><article id="post"><div class="article-container" id="post-content"><p>R语言是一种十分方便的统计学编程语言，本文主要介绍通过R语言进行<em>线性回归</em>，并列举了几个R语言在<em>线性回归</em>中的应用。</p>
<span id="more"></span>

<hr>
<blockquote>
<p>那么接下来是干货时间 QAQ</p>
</blockquote>
<hr>
<h4 id="线性回归计算分为以下几点"><a href="#线性回归计算分为以下几点" class="headerlink" title="线性回归计算分为以下几点"></a>线性回归计算分为以下几点</h4><p>一、判断是否符合线性回归，并求出回归方程<br><code>lm.sol</code> + <code>summary(lm.sol)</code>计算各项的Pr值(即t检验的p值)，<br>Pr&lt; 0.05表示该项系数与t检验默认值(mu=0)之间存在显著差异（即系数显著不为零），此时符合回归，Estimate对应的值为该项系数</p>
<p>二、预测</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">lm.pred&lt;-predict(lm.sol, data.frame(x = 0.16), interval=&quot;prediction&quot;, level=0.95)</span><br></pre></td></tr></table></figure>
<p>For example<img src="/2019/01/10/R-Linear-regression/image005.png" class="" title="残差"><br>输出的三个值分别为预估值，区间下限和区间上限</p>
<p>三、查找偏差值</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">y.res&lt;-resid(lm.sol)</span><br><span class="line">plot(y.res)```</span><br><span class="line"></span><br><span class="line">四、逐步回归  </span><br></pre></td></tr></table></figure>
<p>lm.step&lt;-step(lm.sol)<br>drop1(lm.step)  #查看每项的AIC<br>summary(lm.step)</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">五、画拟合曲线</span><br></pre></td></tr></table></figure>
<p>x&lt;-seq(min(X1), max(X1), len=200)<br>y&lt;-predict(lm2.sol, data.frame(X1=x))<br>plot(Y~X1); lines(x,y)```<br>六、残差图</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">y.res&lt;-resid(lm.sol)</span><br><span class="line">y.rst&lt;-rstandard(lm.sol) #标准化</span><br><span class="line">y.fit&lt;-predict(lm.sol)</span><br><span class="line">#普通残差图</span><br><span class="line">plot(y.res~y.fit)</span><br><span class="line">#标准化残差图</span><br><span class="line">plot(y.rst~y.fit)</span><br></pre></td></tr></table></figure>
<p>漏斗形-&gt;异方差  &amp;&amp;  无规律—&gt;同方差(正常情况)</p>
<img src="/2019/01/10/R-Linear-regression/image001.png" class="" title="ex1">
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">x&lt;-scan()</span><br><span class="line">5.1 1907 3.5 1287 7.1 2700 6.2 2373 8.8 3260 7.8 3000 4.5 1947 5.6 2273 8.0 3113 6.4 2493</span><br><span class="line"></span><br><span class="line">dim(x)&lt;-c(2,10)</span><br><span class="line">x&lt;-t(x)</span><br><span class="line">colnames(x)&lt;-c(&quot;X&quot;,&quot;Y&quot;)</span><br><span class="line">x&lt;-as.data.frame(x)</span><br><span class="line">plot(x$X,x$Y)</span><br></pre></td></tr></table></figure>
<p>(1)<img src="/2019/01/10/R-Linear-regression/Rplot.png" class="" title="ex1"><br>呈线性关系</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">lm.sol&lt;-lm(Y~X,data=x)</span><br><span class="line">summary(lm.sol)</span><br></pre></td></tr></table></figure>
<img src="/2019/01/10/R-Linear-regression/Run1.png" class="" title="ex1">
<p>(2 &amp; 3)<br>y=364.18x+140.95<br>回归数据的显著性检验是指看Pr值是否&lt;0.05,Pr&lt;0.05时为显著的<br>X的系数显著，常数项系数不显著<br><code>abline(lm.sol)</code></p>
<img src="/2019/01/10/R-Linear-regression/Rplot1.png" class="" title="ex1">
<p>(4)<br>已知其中部分数据，预测剩余值用predict<br>predict(lm对象,新数据的data.frame ,interval=”prediction”)</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">new&lt;-data.frame(X=7)</span><br><span class="line">lm.pred&lt;-predict(lm.sol,new,interval=&quot;prediction&quot;)</span><br></pre></td></tr></table></figure>
<p>#Y(7)= 2690.227, [2454.971,2925.484]</p>
<hr>
<img src="/2019/01/10/R-Linear-regression/image006.png" class="" title="ex2">
<img src="/2019/01/10/R-Linear-regression/image007.png" class="" title="ex2">
<p>(1)</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">x&lt;-scan()</span><br><span class="line">0.4 52 158 64 0.4 23 163 60 3.1 19 37 71 0.6 34 157 61 4.7 24 59 54 1.7 65 123 77 9.4 44 46 81 </span><br><span class="line">10.1 31 117 93 11.6 29 173 93 12.6 58 112 51 10.9 37 111 76 23.1 46 114 96 23.1 50 134 77</span><br><span class="line">21.6 44 73 93 23.1 56 168 95 1.9 36 143 54 26.8 58 202 168 29.9 51 124 99</span><br><span class="line"></span><br><span class="line">dim(x)&lt;-c(4,18)</span><br><span class="line">x&lt;-t(x)</span><br><span class="line">colnames(x)&lt;-c(&quot;x1&quot;,&quot;x2&quot;,&quot;x3&quot;,&quot;y&quot;)</span><br><span class="line">x&lt;-data.frame(x)</span><br><span class="line">lm.sol&lt;-lm(y~x1+x2+x3,data=x)</span><br><span class="line">summary(lm.sol)</span><br></pre></td></tr></table></figure>
<img src="/2019/01/10/R-Linear-regression/Run2.png" class="" title="ex2">
<p>(2)<br>Pr&lt;0.05表示显著<br>x1和常数项显著,其他不显著<br>(3)<br><code>lm.step&lt;-step(lm.sol)</code></p>
<img src="/2019/01/10/R-Linear-regression/Run3.png" class="" title="ex2">
<p>#x2被删去<br><code>summary(lm.step)</code></p>
<img src="/2019/01/10/R-Linear-regression/Run4.png" class="" title="ex2">
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">lm.final&lt;-lm(y~x1,data = x)</span><br><span class="line">summary(lm.final)</span><br></pre></td></tr></table></figure>
<img src="/2019/01/10/R-Linear-regression/Run5.png" class="" title="ex2">
<p>p&lt;0.05<br>可以,y = 1.84x + 59.25</p>
<hr>
<img src="/2019/01/10/R-Linear-regression/image008.png" class="" title="ex3">
<p>(1)</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">x&lt;-scan()</span><br><span class="line">1 0.6 1 1.6 1 0.5 1 1.2 2 2.0 2 1.3 2 2.5 3 2.2 3 2.4 3 1.2 4 3.5 4 4.1 4 5.1 5 5.7 6 3.4 </span><br><span class="line">6 9.7 6 8.6 7 4.0 7 5.5 7 10.5 8 17.5 8 13.4 8 4.5 9 30.4 11 12.4 12 13.4 12 26.2 12 7.4</span><br><span class="line"></span><br><span class="line">dim(x)&lt;-c(2,28)</span><br><span class="line">x&lt;-t(x)</span><br><span class="line">colnames(x)&lt;-c(&quot;x&quot;,&quot;y&quot;)</span><br><span class="line">x&lt;-data.frame(x)</span><br><span class="line">plot(x$x,x$y)</span><br><span class="line">lm.sol&lt;-lm(y~x,data=x)</span><br><span class="line">summary(lm.sol)</span><br></pre></td></tr></table></figure>
<img src="/2019/01/10/R-Linear-regression/Run6.png" class="" title="ex3">
<p><code>abline(lm.sol)</code></p>
<img src="/2019/01/10/R-Linear-regression/image009.png" class="" title="ex3">

<p>(2)<br>Pr的值为T检验的P值,F-statistic的p-value表示F检验的p值,两者都是&lt; 0.05时通过<br>Pr常数项&gt;0.05,x的&lt; 0.05,故常数项没通过t检验,x项通过了<br>F-statistic的p-value&lt; 0.05,通过了F检验<br>(3)</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">y.res&lt;-resid(lm.sol); y.fit&lt;-predict(lm.sol)</span><br><span class="line">plot(y.res~y.fit)</span><br></pre></td></tr></table></figure>
<img src="/2019/01/10/R-Linear-regression/image010.png" class="" title="ex3">
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">y.rst&lt;-rstandard(lm.sol)</span><br><span class="line">plot(y.rst~y.fit)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<img src="/2019/01/10/R-Linear-regression/image011.png" class="" title="ex3">
<p>喇叭形，异方差的<br>(4)</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">lm2&lt;-lm(y~x,data=x)</span><br><span class="line">lm2_sq&lt;-update(lm2,sqrt(.)~.)</span><br><span class="line">summary(lm2_sq)</span><br></pre></td></tr></table></figure>
<img src="/2019/01/10/R-Linear-regression/Run7.png" class="" title="ex3">
<p>R-squared还较小，但残差明显变小了（0.7206）</p>
<hr>
<img src="/2019/01/10/R-Linear-regression/image012.png" class="" title="ex3">
<img src="/2019/01/10/R-Linear-regression/image013.png" class="" title="ex3">
<p>toothpaste&lt;-data.frame(<br>   X1=c(-0.05, 0.25,0.60,0,   0.25,0.20, 0.15,0.05,-0.15, 0.15,<br>         0.20, 0.10,0.40,0.45,0.35,0.30, 0.50,0.50, 0.40,-0.05,<br>        -0.05,-0.10,0.20,0.10,0.50,0.60,-0.05,0,    0.05, 0.55),<br>   X2=c( 5.50,6.75,7.25,5.50,7.00,6.50,6.75,5.25,5.25,6.00,<br>         6.50,6.25,7.00,6.90,6.80,6.80,7.10,7.00,6.80,6.50,<br>         6.25,6.00,6.50,7.00,6.80,6.80,6.50,5.75,5.80,6.80),<br>   Y =c( 7.38,8.51,9.52,7.50,9.33,8.28,8.75,7.87,7.10,8.00,<br>         7.89,8.15,9.10,8.86,8.90,8.87,9.26,9.00,8.75,7.95,<br>         7.65,7.27,8.00,8.50,8.75,9.21,8.27,7.67,7.93,9.26)<br>)<br>lm.sol&lt;-lm(Y~X1+X2,data = toothpaste)<br>summary(lm.sol)</p>
<h2 id="–-To-Be-Continued-–"><a href="#–-To-Be-Continued-–" class="headerlink" title="– To  Be  Continued –"></a><em>– To  Be  Continued –</em></h2><img src="/2019/01/10/R-Linear-regression/R.jpg" class="" title="ex3">



















<p><code>&lt;meta http-equiv=&quot;refresh&quot; content=&quot;0.5&quot;&gt;</code></p>
</div></article><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/R%E8%AF%AD%E8%A8%80/">R语言</a><a class="post-meta__tags" href="/tags/%E7%BA%BF%E6%80%A7%E5%9B%9E%E5%BD%92/">线性回归</a></div><nav id="pagination"><div class="prev-post pull-left"><a href="/2019/03/22/gene-chip/"><i class="fa fa-chevron-left">  </i><span>基因芯片分析</span></a></div><div class="next-post pull-right"><a href="/2018/12/31/happy-new-years/"><span>Happy New Year</span><i class="fa fa-chevron-right"></i></a></div></nav></div></div><footer class="footer-bg" style="background-image: url(/sabar.jpg)"><div class="layout" id="footer"><div class="copyright">&copy;2018 - 2021 By 双语之城</div><div class="framework-info"><span>Driven - </span><a target="_blank" rel="noopener" href="http://hexo.io"><span>Hexo</span></a><span class="footer-separator">|</span><span>Theme - </span><a target="_blank" rel="noopener" href="https://github.com/Molunerfinn/hexo-theme-melody"><span>Melody</span></a></div><div class="busuanzi"><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span id="busuanzi_container_page_pv"><i class="fa fa-file-o"></i><span id="busuanzi_value_page_pv"></span><span></span></span></div></div></footer><i class="fa fa-arrow-up" id="go-up" aria-hidden="true"></i><script src="https://cdn.jsdelivr.net/npm/animejs@latest/anime.min.js"></script><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@latest/velocity.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-ui-pack@latest/velocity.ui.min.js"></script><script src="/js/utils.js?version=1.6.1"></script><script src="/js/fancybox.js?version=1.6.1"></script><script src="/js/sidebar.js?version=1.6.1"></script><script src="/js/copy.js?version=1.6.1"></script><script src="/js/fireworks.js?version=1.6.1"></script><script src="/js/transition.js?version=1.6.1"></script><script src="/js/scroll.js?version=1.6.1"></script><script src="/js/head.js?version=1.6.1"></script><script>if(/Android|webOS|iPhone|iPod|BlackBerry/i.test(navigator.userAgent)) {
  $('#nav').addClass('is-mobile')
  $('footer').addClass('is-mobile')
}</script><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"jsonPath":"/live2dw/assets/hijiki.model.json"},"display":{"position":"right","width":150,"height":300},"mobile":{"show":true},"log":false});</script></body></html>